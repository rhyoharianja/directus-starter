# General Configuration
# ---------------------
# Public URL for the project. Used for password resets, email links, etc.
# Ensure this matches your external facing URL and port.
PUBLIC_URL=http://localhost:8899

# PM2 Process Manager Settings
# ---------------------
# Set to 'true' to run Directus with PM2 (requires custom Dockerfile setup).
# Set to 'false' to run with standard 'directus start'.
USE_PM2=false

# Number of instances to run. 'max' uses all available CPU cores.
# Integer value (e.g., 2) or 'max'.
PM2_INSTANCES=max

# Execution mode. 'cluster' enables load balancing across instances.
# Options: 'cluster', 'fork'.
PM2_EXEC_MODE=cluster

# Memory limit before auto-restart. Helps prevent memory leaks.
# Format: '1G', '512M'.
PM2_MAX_MEMORY_RESTART=1G

# Enable/Disable auto-restart on crash.
PM2_AUTO_RESTART=true

# Maximum number of restarts allowed within a timeframe before giving up.
PM2_MAX_RESTARTS=10

# Delay between restarts in milliseconds.
PM2_RESTART_DELAY=3000

# Time to wait for process to kill (ms).
PM2_KILL_TIMEOUT=3000

# Time to wait for app to listen (ms).
PM2_LISTEN_TIMEOUT=10000

# Database Connection
# ---------------------
# Database client. Options: 'pg' (PostgreSQL), 'mysql', 'sqlite3', etc.
DB_CLIENT="pg"

# Database host. Use IP if using 'bridge' network mode, or service name if 'external' network.
DB_HOST="172.17.0.2"

# Database port. Default PostgreSQL: 5432, MySQL: 3306.
DB_PORT="5432"

# Database name.
DB_DATABASE="your_database_name"

# Database user.
DB_USER="your_database_user"

# Database password.
DB_PASSWORD="your_database_password"

# Use SSL for database connection. 'true' or 'false'.
DB_SSL="false"

# Security & Secrets
# ---------------------
# Unique secret key for signing tokens. MUST be a long, random string.
# DO NOT SHARE this value.
SECRET="replace_with_long_random_string_min_32_chars"

# Extensions
# ---------------------
# Path to local extensions directory.
EXTENSIONS_PATH="./extensions"

# Automatically reload extensions on change (dev only). Set 'false' in production.
EXTENSIONS_AUTO_RELOAD=true


# Admin User
# ---------------------
# Initial admin email to create on first bootstrap.
ADMIN_EMAIL="admin@example.com"

# Initial admin password.
ADMIN_PASSWORD="secure_password"

# Cache Configuration (Redis)
# ---------------------
# Enable caching. Highly recommended for production.
CACHE_ENABLED=true

# Cache storage. Options: 'memory', 'redis'.
CACHE_STORE=redis

# Redis connection string.
# Format: redis://[user]:[password]@[host]:[port]
CACHE_REDIS="redis://your_redis_host:6379"

# Cache namespace/prefix. Useful when sharing a Redis instance.
CACHE_NAMESPACE="directus_prod"

# Logging
# ---------------------
# Log level. Options: 'fatal', 'error', 'warn', 'info', 'debug', 'trace'.
LOG_LEVEL=info

# Log style. Options: 'raw' (JSON), 'pretty'.
LOG_STYLE=raw

# Log Retention
# ---------------------
# Enable automatic cleanup of old data.
RETENTION_ENABLED=true
# Cleanup schedule (Cron syntax).
RETENTION_SCHEDULE="0 0 * * *"
# Number of items to delete per batch.
RETENTION_BATCH=500
# Retention period for Activity Feed (e.g., '30d', '90d').
ACTIVITY_RETENTION="90d"
# Retention period for Content Revisions.
REVISIONS_RETENTION="90d"
# Retention period for Flow execution logs.
FLOW_LOGS_RETENTION="30d"

# Database Pooling
# ---------------------
# Minimum number of connections in the pool.
DB_POOL_MIN=2

# Maximum number of connections in the pool.
DB_POOL_MAX=10

# Rate Limiting
# ---------------------
# Storage for rate limiter. 'redis' is persistent and scalable.
RATE_LIMITER_STORE=redis

# Enable API rate limiting.
RATE_LIMITER_ENABLED=true

# Number of requests allowed per duration.
RATE_LIMITER_POINTS=100

# Duration in seconds for the rate limit window.
RATE_LIMITER_DURATION=60

# Token Security
# ---------------------
# Access token Time-To-Live.
ACCESS_TOKEN_TTL="15m"

# Refresh token Time-To-Live.
REFRESH_TOKEN_TTL="7d"

# HTTP Security Headers
# ---------------------
# Enable Strict-Transport-Security (HSTS). Requires SSL.
HSTS_ENABLED=true

# CORS (Cross-Origin Resource Sharing)
# ---------------------
# Enable CORS protections.
CORS_ENABLED=true

# Allowed origins. comma-separated list or regex.
CORS_ORIGIN="https://yourdomain.com"

# Allowed HTTP methods.
CORS_METHODS="GET,POST,PATCH,DELETE"

# Password Hashing
# ---------------------
# Argon2 memory cost. Higher is more secure but consumes more RAM.
HASH_MEMORY_COST=4096

# Argon2 parallelism threads.
HASH_PARALLELISM=2


# Upload Limits
# ---------------------
# Maximum request body size (uploads). Format: '1mb', '500kb'.
MAX_PAYLOAD_SIZE="1mb"
